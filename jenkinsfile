pipeline {
   agent any

   environment {

       def mvnHome = tool 'Maven3.8.6'
       def mvnCMD ="${mvnHome}/bin/mvn"

       registryName = 'edhriacr2022'
       registryUrl = 'edhriacr2022.azurecr.io'
       registryCredential = 'azurecontainer'
       dockerImage = ''
    }

  

   stages {
        stage('Verify Branch') {
         steps {
            echo "$GIT_BRANCH"
            }
         }
               
        stage('Build Stage') {
            steps {
            echo 'Building..'
               script { 
               sh 'docker images -a'
               sh 'cd ~/shopfront/target/'
              //sh '${mvnHome}/bin/mvn clean install -f shopfront/pom.xml'
               sh 'docker build -t shopfront:1.0 . '
               sh 'docker images -a'
               sh 'cd ..'
               }
            }
        }
        stage('Test Stage') {
            steps {
                echo 'Testing..'
            }
        }
        stage('Deploy Stage') {
            steps {
                echo 'Deploying....'
            }
        }
    }
 }  

